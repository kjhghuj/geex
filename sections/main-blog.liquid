{% schema %}
{
  "name": "Blog Posts",
  "settings": [
    {
      "type": "range",
      "id": "posts_per_page",
      "min": 6,
      "max": 24,
      "step": 3,
      "default": 12,
      "label": "Posts per page"
    }
  ]
}
{% endschema %}

{% paginate blog.articles by section.settings.posts_per_page %}

<div class="animate-fade-in max-w-7xl mx-auto px-4 py-12">
    <div class="text-center mb-16">
        <h2 class="text-3xl md:text-4xl font-bold text-slate-900 mb-2 tracking-tight">{{ blog.title }}</h2>
        <div class="w-12 h-1 bg-sky-500 mx-auto rounded-full mb-4"></div>
        <p class="text-slate-500">Insights and Updates</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-12 gap-12">
        <div class="md:col-span-3">
            <div class="bg-white rounded-3xl p-6 border border-gray-100 shadow-lg shadow-gray-100/50 sticky top-32">
                <h3 class="text-lg font-bold text-slate-900 mb-6 px-2">Categories</h3>
                <div class="space-y-2">
                    <a href="{{ blog.url }}" 
                       class="block w-full text-left px-4 py-3 rounded-2xl text-sm font-medium transition-all {% if current_tags == blank %}bg-sky-50 text-sky-600 shadow-sm{% else %}text-gray-500 hover:text-slate-900 hover:bg-gray-50{% endif %}">
                        <div class="flex justify-between items-center">
                            <span>All</span>
                            {% if current_tags == blank %}
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>
                            {% endif %}
                        </div>
                    </a>

                    {% for tag in blog.all_tags %}
                        {% if current_tags contains tag %}
                            <span class="block w-full text-left px-4 py-3 rounded-2xl text-sm font-medium bg-sky-50 text-sky-600 shadow-sm cursor-default">
                                <div class="flex justify-between items-center">
                                    <span>{{ tag }}</span>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>
                                </div>
                            </span>
                        {% else %}
                            {{ tag | link_to_tag: tag | replace: '<a', '<a class="block w-full text-left px-4 py-3 rounded-2xl text-sm font-medium text-gray-500 hover:text-slate-900 hover:bg-gray-50 transition-all"' }}
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="md:col-span-9">
            <div class="mb-6 text-sm text-gray-500">
                Showing {{ paginate.current_offset | plus: 1 }}-{% if paginate.next %}{{ paginate.current_offset | plus: paginate.page_size }}{% else %}{{ paginate.items }}{% endif %} of {{ paginate.items }} articles
            </div>

            <div class="space-y-6">
                {% for article in blog.articles %}
                    {% assign word_count = article.content | strip_html | size %}
                    {% assign read_time = word_count | divided_by: 200 | plus: 1 %}

                    <a href="{{ article.url }}" class="bg-white rounded-3xl p-4 border border-gray-100 hover:border-sky-100 hover:shadow-xl hover:shadow-gray-100 transition-all duration-300 flex flex-col md:flex-row gap-6 group cursor-pointer block">
                        <div class="w-full md:w-64 h-48 rounded-2xl overflow-hidden shrink-0 relative bg-gray-100">
                            {% if article.image %}
                                {% assign img_url = article.image | image_url: width: 600 %}
                                <img 
                                    src="{{ img_url }}" 
                                    alt="{{ article.title | escape }}" 
                                    class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                                    width="600"
                                    height="400"
                                    loading="lazy"
                                >
                            {% endif %}
                            
                            {% if article.tags.size > 0 %}
                                <div class="absolute top-3 left-3 bg-white/90 backdrop-blur text-slate-900 text-[10px] font-bold px-3 py-1.5 rounded-full uppercase tracking-wide">
                                    {{ article.tags.first }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="flex-1 py-2 pr-4 flex flex-col">
                            <div class="flex items-center gap-3 text-xs font-medium text-gray-400 mb-3">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg> 
                                <span>{{ article.published_at | date: "%b %d, %Y" }}</span>
                                <span class="w-1 h-1 bg-gray-300 rounded-full"></span>
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg> 
                                <span>{{ read_time }} min read</span>
                            </div>
                            
                            <h3 class="text-xl font-bold text-slate-900 mb-3 group-hover:text-sky-500 transition-colors leading-tight">
                                {{ article.title }}
                            </h3>
                            
                            <p class="text-gray-500 text-sm leading-relaxed line-clamp-2 mb-6">
                                {{ article.excerpt_or_content | strip_html | truncatewords: 30 }}
                            </p>
                            
                            <div class="mt-auto flex items-center text-sky-500 text-sm font-bold gap-2 group-hover:gap-3 transition-all">
                                Read Story 
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
                            </div>
                        </div>
                    </a>
                {% endfor %}
            </div>

            {% if paginate.pages > 1 %}
                <div class="flex justify-center items-center space-x-2 mt-16">
                    {% if paginate.previous %}
                        <a href="{{ paginate.previous.url }}" class="p-2 rounded-full border border-gray-100 text-slate-900 hover:bg-gray-50">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
                        </a>
                    {% endif %}
                    
                    {% for part in paginate.parts %}
                        {% if part.is_link %}
                            <a href="{{ part.url }}" class="w-10 h-10 flex items-center justify-center rounded-full font-medium text-sm text-gray-500 hover:bg-gray-50 hover:text-slate-900 transition-all">
                                {{ part.title }}
                            </a>
                        {% else %}
                             {% if part.title == paginate.current_page %}
                                <span class="w-10 h-10 flex items-center justify-center rounded-full font-medium text-sm bg-sky-500 text-white shadow-lg shadow-sky-200">{{ part.title }}</span>
                             {% else %}
                                <span class="w-10 h-10 flex items-center justify-center rounded-full font-medium text-sm text-gray-300">{{ part.title }}</span>
                             {% endif %}
                        {% endif %}
                    {% endfor %}

                    {% if paginate.next %}
                        <a href="{{ paginate.next.url }}" class="p-2 rounded-full border border-gray-100 text-slate-900 hover:bg-gray-50">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>
                        </a>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endpaginate %}